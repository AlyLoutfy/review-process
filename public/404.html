<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <script>
      // GitHub Pages 404 handler for Next.js client-side routing
      // When GitHub Pages can't find a file, it serves this 404.html
      // We redirect to index.html and let Next.js router handle the route
      (function () {
        // Check if Next.js app is already loaded (prevents infinite loops)
        if (window.__NEXT_DATA__ || document.querySelector('script[src*="_next"]')) {
          // Next.js app is already loaded, just update the URL and let it handle routing
          var path = window.location.pathname;
          var search = window.location.search;
          var hash = window.location.hash;
          var basePath = "/review-process";
          
          var relativePath = path;
          if (relativePath.startsWith(basePath)) {
            relativePath = relativePath.substring(basePath.length) || "/";
          }
          
          // Update URL without reload if Next.js router is available
          if (window.next && window.next.router) {
            window.next.router.push(relativePath + search + hash);
          } else {
            // Fallback: just update URL and let Next.js handle it
            window.history.replaceState({}, '', basePath + relativePath + search + hash);
            window.dispatchEvent(new PopStateEvent('popstate'));
          }
          return;
        }

        // Next.js app not loaded yet - do the redirect flow
        var path = window.location.pathname;
        var search = window.location.search;
        var hash = window.location.hash;
        var basePath = "/review-process";

        // Remove trailing slash for consistency
        if (path !== "/" && path.endsWith("/")) {
          path = path.slice(0, -1);
        }

        // Extract the path relative to basePath
        var relativePath = path;
        if (relativePath.startsWith(basePath)) {
          relativePath = relativePath.substring(basePath.length) || "/";
        }

        // Check if we've already tried this redirect (prevent loops)
        var redirectKey = 'nextjs-redirect';
        var lastRedirect = sessionStorage.getItem(redirectKey);
        if (lastRedirect === relativePath + search + hash) {
          // Already tried this, prevent loop - just stay on current page
          console.warn('Redirect loop prevented, staying on 404 page');
          return;
        }

        // Store the original path in sessionStorage for Next.js router
        if (relativePath !== "/" && relativePath !== "/index.html") {
          sessionStorage.setItem(redirectKey, relativePath + search + hash);
        }

        // Redirect to the root index.html which will load Next.js app
        // The app will read from sessionStorage and navigate to the correct route
        window.location.replace(basePath + "/" + search + hash);
      })();
    </script>
    <meta http-equiv="refresh" content="0;url=/review-process/" />
  </head>
  <body>
    <p>Redirecting...</p>
    <noscript>
      <p>JavaScript is required for this application.</p>
      <p><a href="/review-process/">Go to homepage</a></p>
    </noscript>
  </body>
</html>
