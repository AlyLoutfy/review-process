<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <script>
      // GitHub Pages 404 handler for Next.js client-side routing
      // When GitHub Pages can't find a file, it serves this 404.html
      // We redirect to index.html and let Next.js router handle the route
      (function () {
        console.log("[404.html] DEBUG - Starting redirect handler");
        var path = window.location.pathname;
        var search = window.location.search;
        var hash = window.location.hash;
        
        console.log("[404.html] DEBUG - Original path:", path);
        console.log("[404.html] DEBUG - Search:", search);
        console.log("[404.html] DEBUG - Hash:", hash);

        // Remove trailing slash for consistency (Next.js router will handle it)
        if (path !== "/" && path.endsWith("/")) {
          path = path.slice(0, -1);
          console.log("[404.html] DEBUG - Removed trailing slash, new path:", path);
        }

        // Try to access the path directly first (in case it exists as index.html)
        // If the path doesn't end with .html, try with /index.html
        if (!path.endsWith(".html") && path !== "/") {
          // Check if it's a directory path that should have index.html
          var indexPath = path + "/index.html";
          // Try to fetch it first
          fetch(indexPath, { method: "HEAD" })
            .then(function (response) {
              if (response.ok) {
                // The index.html exists, redirect to it
                window.location.replace(path + "/" + search + hash);
              } else {
                // Doesn't exist, let Next.js router handle it
                redirectToIndex();
              }
            })
            .catch(function () {
              // Fetch failed, redirect to index and let Next.js handle it
              redirectToIndex();
            });
        } else {
          redirectToIndex();
        }

        function redirectToIndex() {
          // Redirect to root and let Next.js router handle client-side routing
          var originalPath = path + search + hash;
          console.log("[404.html] DEBUG - Original path before basePath removal:", originalPath);
          
          // Remove basePath from path if present
          var basePath = "/review-process";
          if (originalPath.startsWith(basePath)) {
            originalPath = originalPath.substring(basePath.length) || "/";
            console.log("[404.html] DEBUG - After basePath removal:", originalPath);
          }
          
          if (originalPath !== "/" && originalPath !== "/index.html") {
            // Store original path for Next.js router to pick up
            console.log("[404.html] DEBUG - Storing redirect in sessionStorage:", originalPath);
            sessionStorage.setItem("nextjs-redirect", originalPath);
          } else {
            console.log("[404.html] DEBUG - Path is root, not storing redirect");
          }
          
          var redirectUrl = basePath + "/";
          console.log("[404.html] DEBUG - Redirecting to:", redirectUrl);
          window.location.replace(redirectUrl);
        }
      })();
    </script>
    <meta http-equiv="refresh" content="0;url=/review-process/" />
  </head>
  <body>
    <p>Redirecting...</p>
    <noscript>
      <p>JavaScript is required for this application.</p>
      <p><a href="/">Go to homepage</a></p>
    </noscript>
  </body>
</html>
