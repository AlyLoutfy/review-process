(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3051,e=>{"use strict";var t=e.i(43476),s=e.i(22016),r=e.i(18566),a=e.i(71689),i=e.i(75254);let l=(0,i.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var n=e.i(73375),o=e.i(63059),d=e.i(30592);let c=(0,i.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var m=e.i(95468);let x=(0,i.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);var u=e.i(27612),g=e.i(43531),h=e.i(37727),p=e.i(71645);let b=(0,i.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),f=(0,i.default)("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]);function y({isOpen:e,onClose:s,onSubmit:r,itemName:a,initialText:i="",initialFileName:l=null,createdBy:n=null}){let[o,d]=(0,p.useState)(""),[c,m]=(0,p.useState)(null),[x,u]=(0,p.useState)(!1),g=(0,p.useRef)(null),[y,v]=(0,p.useState)(!1);(0,p.useEffect)(()=>(e?(document.body.style.overflow="hidden",setTimeout(()=>v(!0),10),i&&d(i)):(document.body.style.overflow="unset",requestAnimationFrame(()=>{d(""),m(null),v(!1)})),()=>{document.body.style.overflow="unset"}),[e,i]),(0,p.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&s()};if(e)return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,s]);let w=async e=>{if(e.preventDefault(),o.trim()){u(!0);try{await r(o.trim(),c),d(""),m(null),g.current&&(g.current.value=""),s()}catch{}finally{u(!1)}}};return e?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:`fixed inset-0 z-[10000] flex items-center justify-center transition-opacity duration-200 cursor-pointer backdrop-blur-md ${y?"bg-black/20":"bg-black/0"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:s,children:(0,t.jsxs)("div",{className:`bg-white rounded-lg max-w-2xl w-full overflow-hidden flex flex-col shadow-2xl transition-all duration-200 cursor-default m-4 ${y?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"bg-red-50 border-b border-red-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-red-900",children:"Flag Issue"}),(0,t.jsx)("p",{className:"text-red-700 text-sm mt-1",children:a}),n&&i&&(0,t.jsxs)("p",{className:"text-red-600 text-xs mt-1",children:["Created by ",n]})]}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-red-100 rounded-full transition-colors cursor-pointer",children:(0,t.jsx)(h.X,{className:"w-6 h-6 text-red-700"})})]})}),(0,t.jsxs)("form",{onSubmit:w,className:"flex flex-col flex-1",children:[(0,t.jsxs)("div",{className:"flex-1 p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"issue-text",className:"block text-sm font-medium text-gray-700 mb-2",children:["Describe the issue ",(0,t.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,t.jsx)("textarea",{id:"issue-text",value:o,onChange:e=>d(e.target.value),placeholder:"Please describe the issue you've encountered...",required:!0,rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none resize-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"issue-file",className:"block text-sm font-medium text-gray-700 mb-2",children:["Attach file (optional)",l&&!c&&(0,t.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(Previously: ",l,")"]})]}),c?(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)(f,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:c.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[(c.size/1024).toFixed(2)," KB"]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{m(null),g.current&&(g.current.value="")},className:"p-1 hover:bg-gray-200 rounded transition-colors cursor-pointer text-gray-600",children:(0,t.jsx)(h.X,{className:"w-4 h-4"})})]}):(0,t.jsxs)("label",{htmlFor:"issue-file",className:"flex flex-col items-center justify-center w-full h-32 px-4 py-6 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-red-400 hover:bg-red-50 transition-colors",children:[(0,t.jsx)(b,{className:"w-8 h-8 text-gray-400 mb-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Click to upload or drag and drop"}),(0,t.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"PDF, images, or documents"}),(0,t.jsx)("input",{ref:g,id:"issue-file",type:"file",onChange:e=>{let t=e.target.files?.[0];t&&m(t)},className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif"})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium cursor-pointer",disabled:x,children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:!o.trim()||x,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 active:bg-red-800 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:x?"Submitting...":"Submit Issue"})]})]})]})})}):null}function v({isOpen:e,onClose:s,onConfirm:r,issueText:a,itemName:i}){let[l,n]=(0,p.useState)(!1);return((0,p.useEffect)(()=>(e?(document.body.style.overflow="hidden",setTimeout(()=>n(!0),10)):(document.body.style.overflow="unset",requestAnimationFrame(()=>{n(!1)})),()=>{document.body.style.overflow="unset"}),[e]),(0,p.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&s()};if(e)return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,s]),e)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:`fixed inset-0 z-[10000] flex items-center justify-center transition-opacity duration-200 cursor-pointer backdrop-blur-md ${l?"bg-black/20":"bg-black/0"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:s,children:(0,t.jsxs)("div",{className:`bg-white rounded-lg max-w-md w-full overflow-hidden flex flex-col shadow-2xl transition-all duration-200 cursor-default m-4 ${l?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"bg-green-50 border-b border-green-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-green-100 rounded-full",children:(0,t.jsx)(m.CheckCircle2,{className:"w-6 h-6 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-green-900",children:"Confirm Resolution"}),(0,t.jsx)("p",{className:"text-green-700 text-sm",children:i})]})]}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-green-100 rounded-full transition-colors cursor-pointer",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-green-700"})})]})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsx)("p",{className:"text-gray-700",children:"This item has a flagged issue. Are you sure the following issue has been resolved?"}),(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-red-900 mb-2",children:"Issue:"}),(0,t.jsx)("div",{className:"text-sm text-red-800 whitespace-pre-wrap break-words",children:a})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:'Clicking "Confirm & Approve" will mark this item as reviewed and remove the issue flag.'})]}),(0,t.jsxs)("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium cursor-pointer",children:"Cancel"}),(0,t.jsxs)("button",{onClick:()=>{r(),s()},className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 active:bg-green-800 transition-all font-medium shadow-sm hover:shadow-md cursor-pointer flex items-center gap-2",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-4 h-4"}),"Confirm & Approve"]})]})]})})}):null}function w({isOpen:e,onClose:s,onConfirm:r,issueText:a,itemName:i}){let[l,n]=(0,p.useState)(!1);return((0,p.useEffect)(()=>(e?(document.body.style.overflow="hidden",setTimeout(()=>n(!0),10)):(document.body.style.overflow="unset",requestAnimationFrame(()=>{n(!1)})),()=>{document.body.style.overflow="unset"}),[e]),(0,p.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&s()};if(e)return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,s]),e)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:`fixed inset-0 z-[10000] flex items-center justify-center transition-opacity duration-200 cursor-pointer backdrop-blur-md ${l?"bg-black/20":"bg-black/0"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:s,children:(0,t.jsxs)("div",{className:`bg-white rounded-lg max-w-md w-full overflow-hidden flex flex-col shadow-2xl transition-all duration-200 cursor-default m-4 ${l?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"bg-red-50 border-b border-red-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-red-100 rounded-full",children:(0,t.jsx)(u.Trash2,{className:"w-6 h-6 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-red-900",children:"Delete Issue"}),(0,t.jsx)("p",{className:"text-red-700 text-sm",children:i})]})]}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-red-100 rounded-full transition-colors cursor-pointer",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-red-700"})})]})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsx)("p",{className:"text-gray-700",children:"Are you sure you want to delete this issue? This action cannot be undone."}),(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-red-900 mb-2",children:"Issue to be deleted:"}),(0,t.jsx)("div",{className:"text-sm text-red-800 whitespace-pre-wrap break-words",children:a})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"The card will return to pending review status after deletion."})]}),(0,t.jsxs)("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium cursor-pointer",children:"Cancel"}),(0,t.jsxs)("button",{onClick:()=>{r(),s()},className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 active:bg-red-800 transition-all font-medium shadow-sm hover:shadow-md cursor-pointer flex items-center gap-2",children:[(0,t.jsx)(u.Trash2,{className:"w-4 h-4"}),"Delete Issue"]})]})]})})}):null}function j({isOpen:e,onClose:s,onSelectUnit:r,units:a,unitDesigns:i}){let[l,n]=(0,p.useState)(null),[o,d]=(0,p.useState)(!1);(0,p.useEffect)(()=>(e?(document.body.style.overflow="hidden",setTimeout(()=>d(!0),10),requestAnimationFrame(()=>{n(null)})):(document.body.style.overflow="unset",requestAnimationFrame(()=>{d(!1)})),()=>{document.body.style.overflow="unset"}),[e]),(0,p.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&s()};if(e)return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,s]);let c=[...a].sort((e,t)=>e.id.localeCompare(t.id));return e?(0,t.jsx)("div",{className:`fixed inset-0 z-[10000] flex items-center justify-center transition-opacity duration-200 cursor-pointer backdrop-blur-md ${o?"bg-black/20":"bg-black/0"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:s,children:(0,t.jsxs)("div",{className:`bg-white rounded-lg max-w-3xl w-full max-h-[80vh] overflow-hidden flex flex-col shadow-2xl transition-all duration-200 cursor-default m-4 ${o?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"bg-blue-50 border-b border-blue-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-blue-900",children:"Select Unit"}),(0,t.jsx)("p",{className:"text-blue-700 text-sm mt-1",children:"Choose a unit to generate the payment plan preview"})]}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-blue-100 rounded-full transition-colors cursor-pointer",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-blue-700"})})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Unit ID"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Design"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Price"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200",children:c.map(e=>{let s,r=i.find(t=>t.id===e.unitDesignId);return(0,t.jsxs)("tr",{onClick:()=>{n(e.id)},className:`transition-colors cursor-pointer ${l===e.id?"bg-blue-50":"bg-white hover:bg-gray-50"}`,children:[(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("span",{className:"text-sm font-mono text-gray-900",children:e.id})}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("span",{className:"text-sm text-gray-700",children:r?.name||"Unknown"})}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:(s=e.price,new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s)+" EGP")})}),(0,t.jsx)("td",{className:"px-4 py-2",children:l===e.id&&(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)("div",{className:"p-1 bg-blue-500 rounded-full",children:(0,t.jsx)(g.Check,{className:"w-4 h-4 text-white"})})})})]},e.id)})})]})})}),(0,t.jsxs)("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium cursor-pointer",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{if(l){let e=a.find(e=>e.id===l);e&&(r(e),s())}},disabled:!l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:"Generate Payment Plan"})]})]})}):null}function N({plan:e,isReviewed:s,reviewRecord:r,onToggleReviewed:a,hasIssues:i,latestIssue:l,onIssueSubmit:n,onResolveIssue:o,onDeleteIssue:d,units:b,unitDesigns:f}){let[N,k]=(0,p.useState)(!1),[C,I]=(0,p.useState)(!1),[$,S]=(0,p.useState)(!1),[E,R]=(0,p.useState)(!1),[P,A]=(0,p.useState)({x:0,y:0}),[U,D]=(0,p.useState)(!1),T=(0,p.useRef)(null);return(0,p.useEffect)(()=>()=>{T.current&&clearTimeout(T.current)},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:`rounded-lg shadow-sm hover:shadow-md transition-all duration-300 p-4 border-2 ${s?"bg-green-50/60 border-green-400/60":i?"bg-red-50/60 border-red-400/60":"bg-white border-transparent hover:border-blue-400/60 hover:bg-gray-50/50"}`,children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsx)("h3",{className:`text-lg font-semibold flex-1 break-words ${s?"text-gray-700 line-through":"text-gray-900"}`,children:e.name}),(0,t.jsxs)("div",{className:"flex flex-col items-end gap-2 ml-2 flex-shrink-0 w-full max-w-[140px]",children:[(0,t.jsxs)("div",{className:"flex flex-col items-end w-full",children:[(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),i&&!s&&l?I(!0):a()},className:`group flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg transition-all duration-200 cursor-pointer w-full justify-center ${s?"bg-green-100 hover:bg-green-200 border border-green-300":"bg-white hover:bg-green-50 border border-gray-300 hover:border-green-300"}`,"aria-label":s?"Mark as pending":"Mark as reviewed",title:s?"Mark as pending":"Mark as reviewed",children:[(0,t.jsx)(m.CheckCircle2,{className:`w-4 h-4 transition-colors ${s?"text-green-700 fill-green-700":"text-gray-600 group-hover:text-green-600"}`}),(0,t.jsx)("span",{className:`text-xs font-medium ${s?"text-green-700":"text-gray-600 group-hover:text-green-600"}`,children:s?"Approved":"Approve"})]}),s&&r&&(0,t.jsxs)("div",{className:"text-[10px] text-green-600/80 mt-0.5 text-right w-full flex items-center justify-end gap-1",children:["by ",r.userName,(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("img",{src:"/review-process/images/sodic.png",alt:"Sodic",className:"w-[14px] h-[14px] object-contain cursor-pointer",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="/images/sodic.png")}}),(0,t.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap pointer-events-none z-50",children:["Sodic",(0,t.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-[4px] border-r-[4px] border-t-[4px] border-transparent border-t-gray-900"})]})]})]})]}),(0,t.jsxs)("div",{className:"relative z-50 w-full",children:[(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),k(!0)},onMouseEnter:e=>{if(i){T.current&&(clearTimeout(T.current),T.current=null);let t=e.currentTarget.getBoundingClientRect();A({x:t.left+t.width/2,y:t.top}),R(!0)}},onMouseLeave:()=>{T.current=setTimeout(()=>{R(!1)},200)},className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg transition-all duration-200 cursor-pointer relative group w-full justify-center ${i?"bg-red-100 hover:bg-red-200 border border-red-300":"bg-white hover:bg-red-50 border border-gray-300 hover:border-red-300"}`,"aria-label":"Flag issue",title:i?"View issue":"Flag issue",children:[(0,t.jsx)(x,{className:`w-4 h-4 transition-colors ${i?"text-red-700 fill-red-700":"text-gray-600 group-hover:text-red-600"}`}),(0,t.jsx)("span",{className:`text-xs font-medium ${i?"text-red-700":"text-gray-600 group-hover:text-red-600"}`,children:i?"View Issue":"Flag Issue"})]}),i&&l&&(0,t.jsxs)("div",{className:`fixed w-72 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-2xl transition-all duration-200 z-[9999] ${E?"opacity-100 visible scale-100 pointer-events-auto":"opacity-0 invisible scale-95 pointer-events-none"}`,style:{left:`${P.x}px`,top:`${P.y-10}px`,transform:E?"translate(-50%, -100%) scale(1)":"translate(-50%, -100%) scale(0.95)"},onMouseEnter:()=>{T.current&&(clearTimeout(T.current),T.current=null),R(!0)},onMouseLeave:()=>{T.current=setTimeout(()=>{R(!1)},200)},children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold text-red-300",children:"Issue Reported"}),l.userName&&(0,t.jsxs)("div",{className:"text-xs text-gray-400 mt-0.5",children:["by ",l.userName]})]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),R(!1),S(!0)},className:"p-1 hover:bg-red-600 rounded transition-colors cursor-pointer flex-shrink-0","aria-label":"Delete issue",children:(0,t.jsx)(u.Trash2,{className:"w-4 h-4 text-red-300"})})]}),(0,t.jsx)("div",{className:"whitespace-pre-wrap break-words",children:l.text}),l.fileName&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-400",children:["File: ",l.fileName]}),(0,t.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-transparent border-t-gray-900 pointer-events-none"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex-1 mb-3 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Down Payment:"}),(0,t.jsxs)("span",{className:`text-base font-bold ${s?"text-gray-500":"text-blue-600"}`,children:[e.downPayment,"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-600",children:"Payment Period:"}),(0,t.jsx)("span",{className:`text-sm font-semibold ${s?"text-gray-500":"text-gray-900"}`,children:0===e.years?"Cash":`${e.years} Year${e.years>1?"s":""}`})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 pt-2 border-t border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.includesMaintenance?(0,t.jsx)(g.Check,{className:"w-4 h-4 text-green-600"}):(0,t.jsx)(h.X,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("span",{className:`text-xs ${e.includesMaintenance?"text-green-700 font-medium":"text-gray-500"}`,children:"Maintenance"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.includesClubFees?(0,t.jsx)(g.Check,{className:"w-4 h-4 text-green-600"}):(0,t.jsx)(h.X,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("span",{className:`text-xs ${e.includesClubFees?"text-green-700 font-medium":"text-gray-500"}`,children:"Club Fees"})]})]})]}),(0,t.jsxs)("button",{onClick:()=>{D(!0)},className:`flex items-center justify-center gap-2 w-full px-3 py-2 rounded-lg transition-all duration-200 text-sm font-medium cursor-pointer ${s?"bg-gray-200 text-gray-600 hover:bg-gray-300":"bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 shadow-sm hover:shadow-md"}`,children:[(0,t.jsx)(c,{className:"w-4 h-4"}),"Preview Payment Plan"]})]})}),(0,t.jsx)(y,{isOpen:N,onClose:()=>k(!1),onSubmit:(e,t)=>{n(e,t)},itemName:e.name,initialText:l?.text||"",initialFileName:l?.fileName||null,createdBy:l?.userName||null}),(0,t.jsx)(v,{isOpen:C,onClose:()=>I(!1),onConfirm:()=>{o(),a()},issueText:l?.text||"",itemName:e.name}),(0,t.jsx)(w,{isOpen:$,onClose:()=>S(!1),onConfirm:d,issueText:l?.text||"",itemName:e.name}),(0,t.jsx)(j,{isOpen:U,onClose:()=>D(!1),onSelectUnit:t=>{window.open(e.previewUrl,"_blank")},units:b,unitDesigns:f})]})}let k=(0,i.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),C=(0,i.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function I({isOpen:e,onClose:s,media:r,unitName:a,bedrooms:i,bua:l,initialSection:d,initialImageIndex:c}){let[m,x]=(0,p.useState)(d||"floor"),[u,g]=(0,p.useState)(void 0!==c?c:0),[b,f]=(0,p.useState)(!1),y=(0,p.useRef)(!1),v=(0,p.useRef)(d),w=(0,p.useRef)(c),j=[{id:"floor",label:"Floor Plans",images:r.floorPlans},{id:"offer",label:"Offer Gallery",images:r.offerGallery},{id:"unit",label:"Unit Gallery",images:r.unitGallery}],N=j.find(e=>e.id===m)?.images||[],k=N[u]||null,C=j.find(e=>e.id===m)?.label||"",I=()=>{if(u>0)g(u-1);else{let e=j.findIndex(e=>e.id===m);if(e>0){let t=j[e-1];x(t.id),g(t.images.length-1)}else{let e=j[j.length-1];x(e.id),g(e.images.length-1)}}},$=()=>{if(u<N.length-1)g(u+1);else{let e=j.findIndex(e=>e.id===m);e<j.length-1?x(j[e+1].id):x(j[0].id),g(0)}};return((0,p.useEffect)(()=>(e?(document.body.style.overflow="hidden",requestAnimationFrame(()=>{setTimeout(()=>f(!0),10)}),d&&requestAnimationFrame(()=>{x(d)}),requestAnimationFrame(()=>{setTimeout(()=>{void 0!==c?g(c):g(0),y.current=!0},0)}),v.current=d,w.current=c):(document.body.style.overflow="unset",requestAnimationFrame(()=>{f(!1)}),y.current=!1),()=>{document.body.style.overflow="unset"}),[e,d,c]),(0,p.useEffect)(()=>{e&&y.current&&void 0!==d&&m!==d&&g(0)},[m,e,d]),(0,p.useEffect)(()=>{let t=t=>{e&&("Escape"===t.key?s():"ArrowLeft"===t.key?I():"ArrowRight"===t.key&&$())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,u,N.length,m]),e)?(0,t.jsx)("div",{className:`fixed inset-0 z-[10000] bg-black transition-opacity duration-300 ${b?"opacity-100":"opacity-0"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:s,children:(0,t.jsxs)("div",{className:"relative flex flex-col cursor-default",style:{width:"100%",height:"100%",minHeight:"100vh",margin:0,padding:0},onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 z-20 bg-gradient-to-b from-black/90 via-black/80 to-transparent px-6 pt-4 pb-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-white",children:a}),(void 0!==i||void 0!==l)&&(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[void 0!==i&&(0,t.jsxs)("span",{className:"px-4 py-2 bg-white/15 backdrop-blur-sm rounded-lg text-sm font-semibold text-white border border-white/25 shadow-sm",children:[i," ",1===i?"Bedroom":"Bedrooms"]}),void 0!==l&&(0,t.jsxs)("span",{className:"px-4 py-2 bg-white/15 backdrop-blur-sm rounded-lg text-sm font-semibold text-white border border-white/25 shadow-sm",children:["BUA ",l," sqm"]})]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:j.map(e=>(0,t.jsx)("button",{onClick:()=>{x(e.id),g(0)},className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all cursor-pointer ${m===e.id?"bg-blue-600 text-white":"bg-white/20 text-white hover:bg-white/30"}`,children:e.label},e.id))})]}),(0,t.jsx)("button",{onClick:s,className:"hover:bg-white/20 rounded-full transition-colors cursor-pointer text-white flex items-center justify-center","aria-label":"Close",style:{width:"2rem",height:"2rem",padding:"0.5rem"},children:(0,t.jsx)(h.X,{className:"w-5 h-5"})})]})}),k&&(0,t.jsxs)("div",{className:"flex-1 flex items-center justify-center relative pt-16 pb-16",children:[(0,t.jsx)("button",{onClick:I,className:"absolute left-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full transition-all cursor-pointer backdrop-blur-sm","aria-label":"Previous image",children:(0,t.jsx)(n.ChevronLeft,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"relative w-full h-full flex items-center justify-center px-4",children:(0,t.jsx)("img",{src:k,alt:`${C} ${u+1}`,className:"max-w-[98vw] max-h-[calc(100vh-140px)] w-auto h-auto object-contain",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="https://picsum.photos/seed/999/1200/800")}})}),(0,t.jsx)("button",{onClick:$,className:"absolute right-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full transition-all cursor-pointer backdrop-blur-sm","aria-label":"Next image",children:(0,t.jsx)(o.ChevronRight,{className:"w-6 h-6"})})]}),N.length>1&&(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 z-20 bg-gradient-to-t from-black/90 via-black/80 to-transparent px-6 pt-6 pb-4",children:[(0,t.jsx)("div",{className:"flex gap-2 justify-center mb-3",children:N.map((e,s)=>(0,t.jsxs)("button",{onClick:()=>g(s),className:`relative w-16 h-16 rounded-lg overflow-hidden border-2 transition-all flex-shrink-0 cursor-pointer ${s===u?"border-blue-500 ring-2 ring-blue-400 scale-110":"border-white/30 hover:border-white/60"}`,children:[(0,t.jsx)("img",{src:e,alt:`Thumbnail ${s+1}`,className:"w-full h-full object-cover",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="https://picsum.photos/seed/999/64/64")}}),s===u&&(0,t.jsx)("div",{className:"absolute inset-0 bg-blue-500/20"})]},s))}),N.length>0&&(0,t.jsx)("div",{className:"text-center mb-3",children:(0,t.jsxs)("div",{className:"text-white text-sm font-medium",children:[u+1," / ",N.length]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-white text-xs pb-1",children:[(0,t.jsx)("div",{className:"font-medium",children:C}),(0,t.jsx)("div",{className:"text-white/70",children:"Arrow keys to navigate • ESC to close"})]})]}),N.length<=1&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 z-20 bg-gradient-to-t from-black/80 to-transparent px-6 py-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-white text-xs",children:[(0,t.jsx)("div",{className:"font-medium",children:C}),(0,t.jsx)("div",{className:"text-white/70",children:"Arrow keys to navigate • ESC to close"})]})})]})}):null}function $({media:e,onClick:s,maxImages:r=8,showSections:a=!0,compact:i=!1,showAll:l=!1}){let[n,o]=(0,p.useState)(null),d=(0,p.useRef)(null),c=[{name:"Floor",images:e.floorPlans,color:"bg-green-500",textColor:"text-green-600"},{name:"Offer",images:e.offerGallery,color:"bg-blue-500",textColor:"text-blue-600"},{name:"Unit",images:e.unitGallery,color:"bg-purple-500",textColor:"text-purple-600"}],m=c.reduce((e,t)=>e+t.images.length,0),x=r,u=[];c.forEach(e=>{let t=Math.min(Math.min(e.images.length,Math.ceil(e.images.length/m*r)||Math.floor(x/(c.length-c.indexOf(e)))),x);for(let s=0;s<t&&x>0;s++)u.push({url:e.images[s%e.images.length],section:e.name.toLowerCase(),sectionLabel:e.name,sectionColor:e.textColor}),x--}),x>0&&c.forEach(e=>{for(let t=0;t<x&&e.images.length>0;t++)u.push({url:e.images[t%e.images.length],section:e.name.toLowerCase(),sectionLabel:e.name,sectionColor:e.textColor}),x--});let g=(e,t,s)=>{d.current&&clearTimeout(d.current);let r=e.currentTarget.getBoundingClientRect();d.current=setTimeout(()=>{o({url:t.replace("/400/400","/1200/800"),x:r.left+r.width/2,y:r.top,section:s})},1500)},h=()=>{d.current&&(clearTimeout(d.current),d.current=null),o(null)},b=i?"w-10 h-10":"aspect-square";return(0,t.jsxs)(t.Fragment,{children:[a?(0,t.jsx)("div",{className:"space-y-2",children:c.map((e,a)=>{if(0===e.images.length)return null;let n=l?e.images:e.images.slice(0,i?4:Math.max(2,Math.floor(r/c.length)));return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-gray-900",children:"Offer"===e.name?"Offer Gallery":"Unit"===e.name?"Unit Gallery":"Floor Plans"}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.images.length,")"]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5",children:n.map((r,i)=>{let n=e.name.toLowerCase();return(0,t.jsx)("div",{className:`relative ${l?"w-16 h-16":b} bg-gray-100 rounded overflow-hidden flex-shrink-0 ${s?"cursor-pointer":""}`,onMouseEnter:t=>g(t,r,e.name),onMouseLeave:h,onClick:e=>{e.stopPropagation(),s&&s(n,i)},children:(0,t.jsx)("img",{src:r,alt:`${e.name} Gallery ${i+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="https://picsum.photos/seed/999/400/400")},onLoad:()=>{}})},`${a}-${i}`)})})]},a)})}):(0,t.jsx)("div",{className:"grid grid-cols-4 gap-1",children:u.map((e,r)=>{let a=e.section,i=c.find(t=>t.name.toLowerCase()===e.section),l=i?i.images.indexOf(e.url):0;return(0,t.jsx)("div",{className:`relative ${b} bg-gray-100 rounded overflow-hidden ${s?"cursor-pointer":""}`,onMouseEnter:t=>g(t,e.url,e.section),onMouseLeave:h,onClick:e=>{e.stopPropagation(),s&&s(a,l>=0?l:0)},children:(0,t.jsx)("img",{src:e.url,alt:`Preview ${r+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="https://picsum.photos/400/400?random=999")},onLoad:()=>{}})},`preview-${r}`)})}),n&&(0,t.jsx)("div",{className:"fixed z-[60] pointer-events-none",style:{left:`${n.x}px`,top:`${n.y-10}px`,transform:"translate(-50%, -100%)"},children:(0,t.jsxs)("div",{className:"relative w-[600px] h-[400px] rounded-lg shadow-2xl overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-3 left-3 z-10 bg-gray-900/80 text-white text-xs font-semibold px-3 py-1.5 rounded-md backdrop-blur-sm",children:"Offer"===n.section?"Offer Gallery":"Unit"===n.section?"Unit Gallery":"Floor Plans"}),(0,t.jsx)("img",{src:n.url,alt:"Full quality preview",className:"w-full h-full object-cover",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="https://picsum.photos/seed/999/1200/800")}})]})})]})}function S({isOpen:e,onClose:s,unitDesignName:r,unitIds:a}){let[i,l]=(0,p.useState)(!1);return((0,p.useEffect)(()=>(e?(document.body.style.overflow="hidden",setTimeout(()=>l(!0),10)):(document.body.style.overflow="unset",requestAnimationFrame(()=>{l(!1)})),()=>{document.body.style.overflow="unset"}),[e]),(0,p.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&s()};if(e)return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,s]),e||i)?(0,t.jsx)("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-opacity duration-200 cursor-pointer backdrop-blur-md ${i?"bg-black/20":"bg-black/0"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:s,children:(0,t.jsxs)("div",{className:`bg-white rounded-lg max-w-md w-full overflow-hidden flex flex-col shadow-2xl transition-all duration-200 cursor-default m-4 ${i?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 bg-white",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[(0,t.jsx)("span",{className:"text-gray-900",children:r}),(0,t.jsx)("span",{className:"text-gray-600 font-normal ml-2",children:"assigned to Units:"})]}),(0,t.jsx)("button",{onClick:s,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Close",children:(0,t.jsx)(h.X,{className:"w-5 h-5 text-gray-500"})})]}),(0,t.jsx)("div",{className:"p-5 max-h-96 overflow-y-auto bg-gray-50",children:a.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:a.map(e=>(0,t.jsx)("div",{className:"px-4 py-2.5 bg-white border border-gray-200 rounded-lg text-sm font-mono text-gray-800 hover:border-blue-300 hover:bg-blue-50 transition-colors cursor-default shadow-sm",children:e},e))}):(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"No units assigned to this design."})})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 flex justify-end bg-white",children:(0,t.jsx)("button",{onClick:s,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors cursor-pointer font-medium shadow-sm hover:shadow-md",children:"Close"})})]})}):null}function E({unitDesign:e,isReviewed:s,reviewRecord:r,onToggleReviewed:a,hasIssues:i,latestIssue:l,onIssueSubmit:n,onResolveIssue:o,onDeleteIssue:d,units:g}){let[h,b]=(0,p.useState)(!1),[f,j]=(0,p.useState)(!1),[N,E]=(0,p.useState)(!1),[R,P]=(0,p.useState)(!1),[A,U]=(0,p.useState)(!1),[D,T]=(0,p.useState)({x:0,y:0}),[F,M]=(0,p.useState)(!1),L=(0,p.useRef)(null),[B,z]=(0,p.useState)(),[G,O]=(0,p.useState)();(0,p.useEffect)(()=>()=>{L.current&&clearTimeout(L.current)},[]);let q=(e,t)=>{z(e),O(t),b(!0)},W=g.filter(t=>t.unitDesignId===e.id),V=W.length,X=W.map(e=>e.id).sort();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:`rounded-2xl shadow-sm hover:shadow-xl transition-all duration-300 p-6 relative overflow-hidden ${s?"bg-gradient-to-br from-green-50 to-green-100/50 border-2 border-green-400/60":i?"bg-gradient-to-br from-red-50 to-red-100/50 border-2 border-red-400/60":"bg-white border border-gray-200 hover:border-blue-300 hover:shadow-lg hover:bg-gradient-to-br hover:from-blue-50/30 hover:to-white"}`,children:[!s&&!i&&(0,t.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-100/20 to-transparent rounded-full blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,t.jsxs)("div",{className:"absolute top-5 right-5 flex flex-col items-end gap-2 z-10",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"relative z-50 flex flex-col items-end",children:(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),j(!0)},onMouseEnter:e=>{if(i){L.current&&(clearTimeout(L.current),L.current=null);let t=e.currentTarget.getBoundingClientRect();T({x:t.left+t.width/2,y:t.top}),U(!0)}},onMouseLeave:()=>{L.current=setTimeout(()=>{U(!1)},200)},className:`flex items-center gap-1.5 px-2.5 py-2 rounded-lg transition-all duration-200 cursor-pointer relative group justify-center ${i?"bg-red-100 hover:bg-red-200 border border-red-300 shadow-sm":"bg-white hover:bg-red-50 border border-gray-300 hover:border-red-300 shadow-sm"}`,"aria-label":"Flag issue",title:i?"View issue":"Flag issue",children:[(0,t.jsx)(x,{className:`w-4 h-4 transition-colors ${i?"text-red-700 fill-red-700":"text-gray-600 group-hover:text-red-600"}`}),(0,t.jsx)("span",{className:`text-xs font-semibold ${i?"text-red-700":"text-gray-600 group-hover:text-red-600"}`,children:i?"View Issue":"Flag Issue"})]})}),(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsxs)("button",{onClick:e=>{e.stopPropagation(),i&&!s&&l?E(!0):a()},className:`group flex items-center gap-1.5 px-2.5 py-2 rounded-lg transition-all duration-200 cursor-pointer justify-center ${s?"bg-green-100 hover:bg-green-200 border border-green-300 shadow-sm":"bg-white hover:bg-green-50 border border-gray-300 hover:border-green-300 shadow-sm"}`,"aria-label":s?"Mark as pending":"Mark as reviewed",title:s?"Mark as pending":"Mark as reviewed",children:[(0,t.jsx)(m.CheckCircle2,{className:`w-4 h-4 transition-colors ${s?"text-green-700 fill-green-700":"text-gray-600 group-hover:text-green-600"}`}),(0,t.jsx)("span",{className:`text-xs font-semibold ${s?"text-green-700":"text-gray-600 group-hover:text-green-600"}`,children:s?"Approved":"Approve"})]}),s&&r&&(0,t.jsxs)("div",{className:"text-[10px] text-green-600/80 mt-0.5 text-right flex items-center justify-end gap-1",children:["by ",r.userName,(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("img",{src:"/review-process/images/sodic.png",alt:"Sodic",className:"w-[14px] h-[14px] object-contain cursor-pointer",onError:e=>{let t=e.target;t.dataset.fallbackUsed||(t.dataset.fallbackUsed="true",t.src="/images/sodic.png")}}),(0,t.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 bg-gray-900 text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap pointer-events-none z-50",children:["Sodic",(0,t.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-[4px] border-r-[4px] border-t-[4px] border-transparent border-t-gray-900"})]})]})]})]})]}),i&&l&&(0,t.jsxs)("div",{className:`fixed w-72 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-2xl transition-all duration-200 z-[9999] ${A?"opacity-100 visible scale-100 pointer-events-auto":"opacity-0 invisible scale-95 pointer-events-none"}`,style:{left:`${D.x}px`,top:`${D.y-10}px`,transform:A?"translate(-50%, -100%) scale(1)":"translate(-50%, -100%) scale(0.95)"},onMouseEnter:()=>{L.current&&(clearTimeout(L.current),L.current=null),U(!0)},onMouseLeave:()=>{L.current=setTimeout(()=>{U(!1)},200)},children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold text-red-300",children:"Issue Reported"}),l.userName&&(0,t.jsxs)("div",{className:"text-xs text-gray-400 mt-0.5",children:["by ",l.userName]})]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),U(!1),P(!0)},className:"p-1 hover:bg-red-600 rounded transition-colors cursor-pointer flex-shrink-0","aria-label":"Delete issue",children:(0,t.jsx)(u.Trash2,{className:"w-4 h-4 text-red-300"})})]}),(0,t.jsx)("div",{className:"whitespace-pre-wrap break-words",children:l.text}),l.fileName&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-400",children:["File: ",l.fileName]}),(0,t.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-transparent border-t-gray-900 pointer-events-none"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-8 relative",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 w-64 pr-8 border-r border-gray-200/60",children:[(0,t.jsx)("h3",{className:`text-xl font-bold mb-4 tracking-tight ${s?"text-gray-400 line-through":"text-gray-900"}`,children:e.name}),e.amenities&&e.amenities.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mb-3",children:e.amenities.map((e,s)=>(0,t.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-50 text-blue-700 border border-blue-200/60",children:e},s))}),(0,t.jsxs)("div",{className:"space-y-2.5 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Bedrooms:"}),(0,t.jsx)("span",{className:`text-sm font-bold ${s?"text-gray-400":"text-gray-900"}`,children:0===e.beds?"Studio":`${e.beds} Bed${e.beds>1?"s":""}`})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"BUA:"}),(0,t.jsxs)("span",{className:`text-sm font-bold ${s?"text-gray-400":"text-gray-900"}`,children:[e.bua," m²"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2.5 pt-3 border-t border-gray-200/60",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Units Assigned:"}),(0,t.jsx)("span",{className:`text-sm font-bold ${s?"text-gray-400":"text-blue-600"}`,children:V}),V>0&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),M(!0)},className:"p-1.5 rounded-lg hover:bg-blue-50 text-blue-600 hover:text-blue-700 transition-all duration-200 cursor-pointer -ml-1",title:"View assigned unit IDs","aria-label":"View assigned unit IDs",children:(0,t.jsx)(C,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("button",{onClick:()=>q(),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg transition-all duration-200 text-xs font-medium cursor-pointer h-9 ${s?"bg-gray-100 text-gray-500 hover:bg-gray-200 border border-gray-200":"bg-gradient-to-r from-blue-50 to-blue-100/50 text-blue-700 hover:from-blue-100 hover:to-blue-200 border border-blue-200/60 shadow-sm hover:shadow-md"}`,children:[(0,t.jsx)(k,{className:"w-3.5 h-3.5"}),"View All Media"]}),(0,t.jsxs)("button",{onClick:()=>{window.open(e.previewUrl,"_blank")},className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg transition-all duration-200 text-xs font-medium cursor-pointer h-9 ${s?"bg-gray-200 text-gray-500 hover:bg-gray-300 border border-gray-300":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 shadow-md hover:shadow-lg"}`,children:[(0,t.jsx)(c,{className:"w-3.5 h-3.5"}),"Preview Offer"]})]})]}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)($,{media:e.media,onClick:q,maxImages:999,showSections:!0,compact:!1,showAll:!0})})]})]}),(0,t.jsx)(I,{isOpen:h,onClose:()=>{b(!1),z(void 0),O(void 0)},media:e.media,unitName:e.name,bedrooms:e.beds,bua:e.bua,initialSection:B,initialImageIndex:G}),(0,t.jsx)(y,{isOpen:f,onClose:()=>j(!1),onSubmit:(e,t)=>{n(e,t)},itemName:e.name,initialText:l?.text||"",initialFileName:l?.fileName||null,createdBy:l?.userName||null}),(0,t.jsx)(v,{isOpen:N,onClose:()=>E(!1),onConfirm:()=>{o(),a()},issueText:l?.text||"",itemName:e.name}),(0,t.jsx)(w,{isOpen:R,onClose:()=>P(!1),onConfirm:d,issueText:l?.text||"",itemName:e.name}),(0,t.jsx)(S,{isOpen:F,onClose:()=>M(!1),unitDesignName:e.name,unitIds:X})]})}var R=e.i(57448);function P(e,t){let s=`reviewed-${e}-${t}`,[r,a]=(0,p.useState)(new Map);return(0,p.useEffect)(()=>{(async()=>{try{let e=await R.dbReviewed.get(s);if(e&&Array.isArray(e)){let t=new Map;e.length>0&&(Array.isArray(e[0])&&2===e[0].length?e.forEach(e=>{let[s,r]=e;Array.isArray(r)?t.set(s,{itemId:s,userId:r[0]||"unknown",userName:r[1]||"Unknown User",timestamp:r[2]||new Date().toISOString()}):t.set(s,r)}):e.forEach(e=>{let[s,r]=e;t.set(s,r)})),requestAnimationFrame(()=>{a(t)})}}catch(e){}})()},[s]),{isReviewed:e=>r.has(e),toggleReviewed:async(e,t,r)=>{a(a=>{let i=new Map(a);return i.has(e)?i.delete(e):i.set(e,{itemId:e,userId:t,userName:r,timestamp:new Date().toISOString()}),(async()=>{try{let e=Array.from(i.entries()).map(([e,t])=>[e,[t.userId,t.userName,t.timestamp]]);await R.dbReviewed.set(s,e)}catch(e){}})(),i})},reviewedRecords:r,getReviewRecord:e=>r.get(e)||null}}function A(e,t){let s=`issues-${e}-${t}`,[r,a]=(0,p.useState)(new Map);return(0,p.useEffect)(()=>{(async()=>{try{let e=await R.dbIssues.get(s);if(e&&Array.isArray(e)&&e.length>0){let t=new Map;e.forEach(e=>{let[s,r]=e;Array.isArray(r)&&r.length>0&&(Array.isArray(r[0])&&"string"==typeof r[0][0]?t.set(s,r.map((e,t)=>({id:`${Date.now()}-${t}-${Math.random()}`,text:e[0]||"",fileName:e[1]||null,fileSize:"number"==typeof e[2]?e[2]:null,timestamp:e[3]||new Date().toISOString(),userId:e[4]||"unknown",userName:e[5]||"Unknown User"}))):t.set(s,r))}),requestAnimationFrame(()=>{a(t)})}}catch(e){}})()},[s]),{addIssue:async(e,t,r,i,l,n)=>{a(a=>{let o=new Map(a),d=(o.get(e)||[]).slice(-9),c={id:`${Date.now()}-${Math.random()}`,text:t,fileName:r,fileSize:i,timestamp:new Date().toISOString(),userId:l,userName:n};return o.set(e,[...d,c]),(async()=>{try{let e=Array.from(o.entries()).map(([e,t])=>[e,t.map(e=>[e.text,e.fileName,e.fileSize,e.timestamp,e.userId,e.userName])]);await R.dbIssues.set(s,e)}catch(e){}})(),o})},getIssues:e=>r.get(e)||[],getLatestIssue:e=>{let t=r.get(e);return t&&0!==t.length?t[t.length-1]:null},hasIssues:e=>(r.get(e)?.length||0)>0,removeIssues:async e=>{a(t=>{let r=new Map(t);return r.delete(e),(async()=>{try{let e=Array.from(r.entries()).map(([e,t])=>[e,t.map(e=>[e.text,e.fileName,e.fileSize,e.timestamp,e.userId,e.userName])]);await R.dbIssues.set(s,e)}catch(e){}})(),r})}}}let U="review-process-current-user",D="review-process-users",T=[{id:"user-1",name:"John Doe",email:"john@example.com"},{id:"user-2",name:"Jane Smith",email:"jane@example.com"},{id:"user-3",name:"Mike Johnson",email:"mike@example.com"}];var F=e.i(13117);function M({releaseId:e}){let i=(0,r.usePathname)(),[c,m]=(0,p.useState)("");(0,p.useEffect)(()=>{{let e=window.location.pathname.split("/").filter(Boolean),t=e.indexOf("review-process"),s=t>=0?e.slice(t+1):e,r=s.indexOf("review");if(r>=0&&r+1<s.length){let e=s[r+1];(e=e.replace(/\/$/,""))&&"fallback"!==e&&m(e)}}},[i]);let x=c||e||"",[u,g]=(0,p.useState)("unit-designs"),[h,b]=(0,p.useState)("all"),[f,y]=(0,p.useState)(""),[v,w]=(0,p.useState)(1),[j,k]=(0,p.useState)(10),C=(0,p.useRef)(null),I=(0,p.useRef)(null),[$,S]=(0,p.useState)({width:0,left:0}),[M,L]=(0,p.useState)(void 0),[B,z]=(0,p.useState)(!0);(0,p.useEffect)(()=>{(async()=>{if(console.log("[ReviewPageClient] DEBUG - Loading release, releaseId:",x),console.log("[ReviewPageClient] DEBUG - window check:",!0),console.log("[ReviewPageClient] DEBUG - isFallback:","fallback"===x),x&&"fallback"!==x)try{console.log("[ReviewPageClient] DEBUG - Calling getReleaseById with:",x);let e=await (0,d.getReleaseById)(x);console.log("[ReviewPageClient] DEBUG - Loaded release:",e?{id:e.id,name:e.releaseName,compound:e.compoundName}:"null"),L(e),z(!1)}catch(e){console.error("[ReviewPageClient] DEBUG - Error loading release:",e),z(!1)}else console.log("[ReviewPageClient] DEBUG - Skipping load (no releaseId, no window, or fallback)"),z(!1)})()},[x]);let{currentUser:G}=function(){let[e,t]=(0,p.useState)(null),[s,r]=(0,p.useState)(T);return(0,p.useEffect)(()=>{(async()=>{try{let e=await R.dbUsers.get(U);e?t(e):(t(T[0]),await R.dbUsers.set(U,T[0]));let s=await R.dbUsers.get(D);s&&Array.isArray(s)?r(s):(await R.dbUsers.set(D,T),r(T))}catch(e){t(T[0]),r(T)}})()},[]),{currentUser:e,setUser:async e=>{t(e);try{await R.dbUsers.set(U,e)}catch(e){}},users:s,getUserById:e=>s.find(t=>t.id===e)||null}}(),O=(0,F.useActivityLog)(),q=P(x||"","payment-plan"),W=P(x||"","unit-design"),V=A(x||"","payment-plan"),X=A(x||"","unit-design");if((0,p.useEffect)(()=>{let e=()=>{let e="unit-designs"===u?I.current:C.current;if(e){let{offsetLeft:t,offsetWidth:s}=e;S({width:s,left:t})}};return requestAnimationFrame(()=>{e()}),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[u]),(0,p.useEffect)(()=>{!B&&M&&requestAnimationFrame(()=>{let e="unit-designs"===u?I.current:C.current;if(e){let{offsetLeft:t,offsetWidth:s}=e;S({width:s,left:t})}})},[B,M,u]),(0,p.useEffect)(()=>{w(1)},[h,f,u,j]),B)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading release..."})]})});if(!M)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Release Not Found"}),(0,t.jsx)("p",{className:"text-gray-600",children:"The release you're looking for doesn't exist."})]})});let _=M.paymentPlans.filter(e=>{let t=q.isReviewed(e.id),s=V.hasIssues(e.id),r=!0;"reviewed"===h?r=t:"pending"===h?r=!t&&!s:"flagged"===h&&(r=s);let a=""===f.trim()||e.name.toLowerCase().includes(f.toLowerCase());return r&&a}),J=M.unitDesigns.filter(e=>{let t=W.isReviewed(e.id),s=X.hasIssues(e.id),r=!0;"reviewed"===h?r=t:"pending"===h?r=!t&&!s:"flagged"===h&&(r=s);let a=""===f.trim()||e.name.toLowerCase().includes(f.toLowerCase());return r&&a}),H=_.length,K=Math.ceil(H/j),Y=_.slice((v-1)*j,v*j),Q=H>0?(v-1)*j+1:0,Z=Math.min(v*j,H),ee=J.length,et=Math.ceil(ee/j),es=J.slice((v-1)*j,v*j),er=ee>0?(v-1)*j+1:0,ea=Math.min(v*j,ee);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-gray-50",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"pt-3 pb-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 tracking-tight mb-1.5",children:M.releaseName}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,t.jsx)("span",{className:"px-2.5 py-0.5 bg-blue-100 text-blue-700 font-semibold rounded-full uppercase tracking-wider",children:M.compoundName}),(0,t.jsxs)("span",{children:["Release Date:"," ",(0,t.jsx)("span",{className:"font-medium text-gray-700",children:new Date(M.releaseDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]}),(0,t.jsxs)(s.default,{href:"/",className:"flex items-center gap-1.5 px-3 py-1.5 bg-white hover:bg-gray-50 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 transition-colors duration-200 cursor-pointer shadow-sm hover:shadow-md shrink-0",children:[(0,t.jsx)(a.ArrowLeft,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"All Releases"})]})]}),(0,t.jsx)("div",{className:"relative border-b-2 border-gray-200 pt-2",children:(0,t.jsxs)("div",{className:"flex gap-6 relative -mb-0.5",children:[(0,t.jsx)("button",{ref:I,onClick:()=>{g("unit-designs"),b("all")},className:`px-0 py-2.5 font-semibold text-base transition-all duration-300 relative whitespace-nowrap cursor-pointer ${"unit-designs"===u?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:(0,t.jsxs)("span",{className:"flex items-baseline gap-1.5",children:["Unit Designs",(0,t.jsx)("span",{className:`text-xs font-normal px-1.5 py-0.5 rounded transition-all duration-300 ${"unit-designs"===u?"bg-blue-50 text-blue-600":"bg-transparent text-gray-400"}`,children:M.unitDesigns.length})]})}),(0,t.jsx)("button",{ref:C,onClick:()=>{g("payment-plans"),b("all")},className:`px-0 py-2.5 font-semibold text-base transition-all duration-300 relative whitespace-nowrap cursor-pointer ${"payment-plans"===u?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:(0,t.jsxs)("span",{className:"flex items-baseline gap-1.5",children:["Payment Plans",(0,t.jsx)("span",{className:`text-xs font-normal px-1.5 py-0.5 rounded transition-all duration-300 ${"payment-plans"===u?"bg-blue-50 text-blue-600":"bg-transparent text-gray-400"}`,children:M.paymentPlans.length})]})}),(0,t.jsx)("div",{className:"absolute bottom-0 h-1 bg-blue-600 transition-all duration-300 ease-out rounded-full",style:{width:`${$.width}px`,left:`${$.left}px`,transform:"translateY(30%)"}})]})})]})})}),(0,t.jsx)("main",{className:"bg-gray-50",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"pt-4 pb-8",children:(0,t.jsx)("div",{className:"animate-[fadeIn_0.3s_ease-in-out]",children:"payment-plans"===u?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-6 flex items-center justify-between gap-4 flex-wrap",children:[(0,t.jsx)("div",{className:"flex-1 min-w-[200px] max-w-md",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Search payment plans...",value:f,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,t.jsxs)("button",{onClick:()=>b("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"all"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",M.paymentPlans.length,")"]}),(0,t.jsxs)("button",{onClick:()=>b("reviewed"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"reviewed"===h?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Reviewed (",M.paymentPlans.filter(e=>q.isReviewed(e.id)).length,")"]}),(0,t.jsxs)("button",{onClick:()=>b("pending"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"pending"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Pending (",M.paymentPlans.filter(e=>{let t=q.isReviewed(e.id),s=V.hasIssues(e.id);return!t&&!s}).length,")"]}),(0,t.jsxs)("button",{onClick:()=>b("flagged"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"flagged"===h?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Flagged (",M.paymentPlans.filter(e=>V.hasIssues(e.id)).length,")"]})]})]}),0===Y.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"🔍"}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nothing to see here!"}),(0,t.jsx)("p",{className:"text-gray-600 text-center max-w-md",children:""!==f.trim()?`No payment plans match "${f}". Try adjusting your search or filters.`:"No payment plans match your current filter. Try selecting a different filter option."})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:Y.map(e=>{let s=q.isReviewed(e.id),r=V.getIssues(e.id),a=q.getReviewRecord(e.id);return(0,t.jsx)(N,{plan:e,isReviewed:s,reviewRecord:a,onToggleReviewed:()=>{!G||r.length>0||(q.toggleReviewed(e.id,G.id,G.name),M&&O.addActivity({releaseId:M.id,itemType:"payment-plan",itemId:e.id,itemName:e.name,activityType:s?"unapproved":"approved",userId:G.id,userName:G.name}))},hasIssues:V.hasIssues(e.id),latestIssue:V.getLatestIssue(e.id),onIssueSubmit:(t,r)=>{G&&(s&&q.toggleReviewed(e.id,G.id,G.name),V.addIssue(e.id,t,r?.name||null,r?.size||null,G.id,G.name),M&&O.addActivity({releaseId:M.id,itemType:"payment-plan",itemId:e.id,itemName:e.name,activityType:"flagged",userId:G.id,userName:G.name,details:t}))},onResolveIssue:()=>{G&&(V.removeIssues(e.id),q.toggleReviewed(e.id,G.id,G.name),M&&O.addActivity({releaseId:M.id,itemType:"payment-plan",itemId:e.id,itemName:e.name,activityType:"issue_resolved",userId:G.id,userName:G.name}))},onDeleteIssue:()=>{G&&(V.removeIssues(e.id),M&&O.addActivity({releaseId:M.id,itemType:"payment-plan",itemId:e.id,itemName:e.name,activityType:"issue_deleted",userId:G.id,userName:G.name}))},units:M.units,unitDesigns:M.unitDesigns},e.id)})}),(K>1||H>0)&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4 gap-4 flex-wrap",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsx)("div",{className:"text-sm text-gray-600",children:H>0?(0,t.jsxs)(t.Fragment,{children:["Showing ",Q,"-",Z," of ",H]}):(0,t.jsx)(t.Fragment,{children:"No items"})})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{htmlFor:"itemsPerPage",className:"text-sm text-gray-600 whitespace-nowrap",children:"Show:"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{id:"itemsPerPage",value:j,onChange:e=>k(Number(e.target.value)),className:"px-3 py-1.5 pr-10 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none cursor-pointer bg-white appearance-none",children:[(0,t.jsx)("option",{value:10,children:"10"}),(0,t.jsx)("option",{value:20,children:"20"}),(0,t.jsx)("option",{value:50,children:"50"}),(0,t.jsx)("option",{value:100,children:"100"})]}),(0,t.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),K>1&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>w(e=>Math.max(1,e-1)),disabled:1===v,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent","aria-label":"Previous page",children:(0,t.jsx)(n.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:K},(e,t)=>t+1).map(e=>1===e||e===K||e>=v-1&&e<=v+1?(0,t.jsx)("button",{onClick:()=>w(e),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors cursor-pointer ${v===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e},e):e===v-2||e===v+2?(0,t.jsx)("span",{className:"px-2 text-gray-500",children:"..."},e):null)}),(0,t.jsx)("button",{onClick:()=>w(e=>Math.min(K,e+1)),disabled:v===K,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent","aria-label":"Next page",children:(0,t.jsx)(o.ChevronRight,{className:"w-4 h-4"})})]})]})]})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-6 flex items-center justify-between gap-4 flex-wrap",children:[(0,t.jsx)("div",{className:"flex-1 min-w-[200px] max-w-md",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Search unit designs...",value:f,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,t.jsxs)("button",{onClick:()=>b("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"all"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",M.unitDesigns.length,")"]}),(0,t.jsxs)("button",{onClick:()=>b("reviewed"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"reviewed"===h?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Reviewed (",M.unitDesigns.filter(e=>W.isReviewed(e.id)).length,")"]}),(0,t.jsxs)("button",{onClick:()=>b("pending"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"pending"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Pending (",M.unitDesigns.filter(e=>{let t=W.isReviewed(e.id),s=X.hasIssues(e.id);return!t&&!s}).length,")"]}),(0,t.jsxs)("button",{onClick:()=>b("flagged"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ${"flagged"===h?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Flagged (",M.unitDesigns.filter(e=>X.hasIssues(e.id)).length,")"]})]})]}),0===es.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"🔍"}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nothing to see here!"}),(0,t.jsx)("p",{className:"text-gray-600 text-center max-w-md",children:""!==f.trim()?`No unit designs match "${f}". Try adjusting your search or filters.`:"No unit designs match your current filter. Try selecting a different filter option."})]}):(0,t.jsx)("div",{className:"space-y-6 mb-6",children:es.map(e=>{let s=W.isReviewed(e.id),r=X.getIssues(e.id),a=W.getReviewRecord(e.id);return(0,t.jsx)(E,{unitDesign:e,isReviewed:s,reviewRecord:a,onToggleReviewed:()=>{!G||r.length>0||(W.toggleReviewed(e.id,G.id,G.name),M&&O.addActivity({releaseId:M.id,itemType:"unit-design",itemId:e.id,itemName:e.name,activityType:s?"unapproved":"approved",userId:G.id,userName:G.name}))},hasIssues:X.hasIssues(e.id),latestIssue:X.getLatestIssue(e.id),onIssueSubmit:(t,r)=>{G&&(s&&W.toggleReviewed(e.id,G.id,G.name),X.addIssue(e.id,t,r?.name||null,r?.size||null,G.id,G.name),M&&O.addActivity({releaseId:M.id,itemType:"unit-design",itemId:e.id,itemName:e.name,activityType:"flagged",userId:G.id,userName:G.name,details:t}))},onResolveIssue:()=>{G&&(X.removeIssues(e.id),W.toggleReviewed(e.id,G.id,G.name),M&&O.addActivity({releaseId:M.id,itemType:"unit-design",itemId:e.id,itemName:e.name,activityType:"issue_resolved",userId:G.id,userName:G.name}))},onDeleteIssue:()=>{G&&(X.removeIssues(e.id),M&&O.addActivity({releaseId:M.id,itemType:"unit-design",itemId:e.id,itemName:e.name,activityType:"issue_deleted",userId:G.id,userName:G.name}))},units:M.units},e.id)})}),(et>1||ee>0)&&(0,t.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4 gap-4 flex-wrap",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsx)("div",{className:"text-sm text-gray-600",children:ee>0?(0,t.jsxs)(t.Fragment,{children:["Showing ",er,"-",ea," of ",ee]}):(0,t.jsx)(t.Fragment,{children:"No items"})})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{htmlFor:"itemsPerPageUnitDesigns",className:"text-sm text-gray-600 whitespace-nowrap",children:"Show:"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{id:"itemsPerPageUnitDesigns",value:j,onChange:e=>k(Number(e.target.value)),className:"px-3 py-1.5 pr-10 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none cursor-pointer bg-white appearance-none",children:[(0,t.jsx)("option",{value:10,children:"10"}),(0,t.jsx)("option",{value:20,children:"20"}),(0,t.jsx)("option",{value:50,children:"50"}),(0,t.jsx)("option",{value:100,children:"100"})]}),(0,t.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),et>1&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>w(e=>Math.max(1,e-1)),disabled:1===v,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent","aria-label":"Previous page",children:(0,t.jsx)(n.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:et},(e,t)=>t+1).map(e=>1===e||e===et||e>=v-1&&e<=v+1?(0,t.jsx)("button",{onClick:()=>w(e),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors cursor-pointer ${v===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e},e):e===v-2||e===v+2?(0,t.jsx)("span",{className:"px-2 text-gray-500",children:"..."},e):null)}),(0,t.jsx)("button",{onClick:()=>w(e=>Math.min(et,e+1)),disabled:v===et,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent","aria-label":"Next page",children:(0,t.jsx)(o.ChevronRight,{className:"w-4 h-4"})})]})]})]})]})},u)})})})]})}function L(){let[e,s]=(0,p.useState)(""),[r,a]=(0,p.useState)(!1);return((0,p.useEffect)(()=>{{console.log("[ReviewPageClientWrapper] DEBUG - URL Info:",JSON.stringify({pathname:window.location.pathname,href:window.location.href,search:window.location.search,hash:window.location.hash,sessionStorageRedirect:sessionStorage.getItem("nextjs-redirect")},null,2));let e=sessionStorage.getItem("nextjs-redirect"),t=window.location.pathname;if(e){console.log("[ReviewPageClientWrapper] DEBUG - Found sessionStorage redirect:",e),t=e.startsWith("/")?e:"/"+e,sessionStorage.removeItem("nextjs-redirect");let s="/review-process",r=t.startsWith(s)?t:s+t;console.log("[ReviewPageClientWrapper] DEBUG - Updating history to:",r),window.history.replaceState({},"",r)}console.log("[ReviewPageClientWrapper] DEBUG - Using path:",t);let r=t.split("/").filter(Boolean);console.log("[ReviewPageClientWrapper] DEBUG - Segments:",r);let i=r.indexOf("review-process"),l=i>=0?r.slice(i+1):r;console.log("[ReviewPageClientWrapper] DEBUG - Clean segments (after basePath):",l);let n=l.indexOf("review");if(console.log("[ReviewPageClientWrapper] DEBUG - Review index:",n),n>=0&&n+1<l.length){let e=l[n+1];console.log("[ReviewPageClientWrapper] DEBUG - Extracted releaseId:",e=e.replace(/\/$/,"")),e&&"fallback"!==e?(console.log("[ReviewPageClientWrapper] DEBUG - Setting releaseId to:",e),s(e)):console.log("[ReviewPageClientWrapper] DEBUG - ID is 'fallback' or empty, not setting releaseId"),a(!0)}else console.log("[ReviewPageClientWrapper] DEBUG - Could not find 'review' segment or no segment after it"),console.log("[ReviewPageClientWrapper] DEBUG - Available segments:",l),a(!0)}},[]),r)?(0,t.jsx)(M,{releaseId:e}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-gray-500",children:"Loading..."})})}e.s(["default",()=>L],3051)}]);